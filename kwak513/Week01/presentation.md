# 하드웨어 관점에서 바라본 프로세스와 스레드

## 프로세스와 스레드
1. **프로세스**: 컴퓨터에서 실행되고 있는 프로그램, CPU 스케줄링의 대상이 되는 작업  
2. **스레드**: 프로세스 내 작업 흐름

## 프로그램과 프로세스
![프로세스](./images/1.jfif)

1. 프로그램은 하드디스크(HDD), SSD 같은 보조 기억 장치에 저장된 정적인 코드 덩어리  
2. 프로그램 실행 시, 프로그램을 **주 기억 장치(RAM)**로 불러오고 고유한 메모리 공간 부여  
   - 메모리를 할당받아 실행 준비가 된 상태 = **프로세스**  
3. CPU 스케줄러가 프로세스 관리  
4. CPU가 프로세스를 실제로 실행

## 프로세스의 메모리 구조
![프로세스](./images/2.jfif)

### 1) 정적 영역
- 프로그램 시작부터 끝까지 크기가 변하지 않는 공간

#### 1-1. 코드 영역
- 소스 코드가 들어가는 영역

#### 1-2. 데이터 영역
- 전역 변수, 정적 변수

| 구분 | 내용 | 예시 |
|------|------|------|
| Data Segment | 초기값이 있는 전역/정적 변수 | `int a = 10;` |
| BSS Segment | 초기값이 없는 전역/정적 변수 | `int a;` |

### 2) 동적 영역
- 크기가 동적인 공간

#### 2-1. 힙 영역
- 특징:  
  - `new` 키워드로 생성한 객체, 배열이 저장됨  
  - 런타임에 메모리 크기 결정: `new`를 만나면 그때 필요한 크기 계산  
  - 메모리 누수 예방: 사용 끝난 메모리 직접 해제 (Java는 가비지 컬렉터가 자동)  
  - 낮은 주소 → 높은 주소 방향으로 메모리 사용  

#### 2-2. 스택 영역
- 특징:  
  - 함수의 호출 정보, 매개변수, 지역변수가 저장됨  
  - 컴파일 시점에 메모리 크기 결정, 런타임에 메모리 할당  
  - 함수 실행이 끝나면 자동으로 사라짐  
  - LIFO(Last In First Out)  
  - 높은 주소 → 낮은 주소로 자라남  

> 예) 메모리 주소 1 ~ 10, 힙과 스택 모두 1부터 차지한다면 연속된 메모리 확보가 어려움.  
> 메모리 공간 효율적 사용을 위해, 힙과 스택 두 영역이 서로를 향해 자람.

## 프로세스 생성보다 스레드 생성이 효율적인 이유
1. **프로세스**: 각 프로세스는 독립적인 메모리 공간(코드, 데이터, 힙, 스택)을 가짐  
   - 서로 간 통신 시 복잡한 절차 필요  
2. **스레드**: 같은 프로세스 내 스레드는 코드, 데이터, 힙 영역을 공유하고 스택 영역만 독립적  
   - 자원 공유 → 스레드 간 데이터 통신이 효율적

## 프로세스 컨텍스트 스위칭 VS 스레드 컨텍스트 스위칭
| 구분 | 특징 |
|------|------|
| 프로세스 컨텍스트 스위칭 | 프로세스 간 전환 시 모든 메모리 영역 저장 및 복원 |
| 스레드 컨텍스트 스위칭 | 같은 프로세스 내 스레드 전환 시 스택 영역만 저장/복원, 코드/데이터/힙 유지 |

## 출처
'면접을 위한 CS전공지식노트' 교재 블로그  
[블로그 링크](https://blog.naver.com/jhc9639/222704196744)
